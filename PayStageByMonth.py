#!/usr/bin/env python
# -*- coding: utf-8 -*-
# @File  : PayStageByMonth.py
# @Author: MoonKuma
# @Date  : 2018/11/20
# @Desc  : pay by month


# select '2018-01' as month, level,count(uid) from (select uid,ceil(sum(money/100)/1000) as level from pay_syn_day where date<'2018-01' group by uid)a group by level
#
#
# select * from ( select '2017-01' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2017-01'  group by uid having sum(money/100)<100  )a group by level union all select '2017-02' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2017-02'  group by uid having sum(money/100)<100  )a group by level union all select '2017-03' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2017-03'  group by uid having sum(money/100)<100  )a group by level union all select '2017-04' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2017-04'  group by uid having sum(money/100)<100  )a group by level union all select '2017-05' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2017-05'  group by uid having sum(money/100)<100  )a group by level union all select '2017-06' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2017-06'  group by uid having sum(money/100)<100  )a group by level union all select '2017-07' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2017-07'  group by uid having sum(money/100)<100  )a group by level union all select '2017-08' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2017-08'  group by uid having sum(money/100)<100  )a group by level union all select '2017-09' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2017-09'  group by uid having sum(money/100)<100  )a group by level union all select '2017-10' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2017-10'  group by uid having sum(money/100)<100  )a group by level union all select '2017-11' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2017-11'  group by uid having sum(money/100)<100  )a group by level union all select '2017-12' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2017-12'  group by uid having sum(money/100)<100  )a group by level union all select '2018-01' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2018-01'  group by uid having sum(money/100)<100  )a group by level union all select '2018-02' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2018-02'  group by uid having sum(money/100)<100  )a group by level union all select '2018-03' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2018-03'  group by uid having sum(money/100)<100  )a group by level union all select '2018-04' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2018-04'  group by uid having sum(money/100)<100  )a group by level union all select '2018-05' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2018-05'  group by uid having sum(money/100)<100  )a group by level union all select '2018-06' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2018-06'  group by uid having sum(money/100)<100  )a group by level union all select '2018-07' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2018-07'  group by uid having sum(money/100)<100  )a group by level union all select '2018-08' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2018-08'  group by uid having sum(money/100)<100  )a group by level union all select '2018-09' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2018-09'  group by uid having sum(money/100)<100  )a group by level union all select '2018-10' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2018-10'  group by uid having sum(money/100)<100  )a group by level union all select '2018-11' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2018-11'  group by uid having sum(money/100)<100  )a group by level ) a limit 10;
#
#
# select * from ( select '2018-03' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2018-03'  group by uid having sum(money/100)<100  )a group by level union all select '2018-04' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2018-04'  group by uid having sum(money/100)<100  )a group by level union all select '2018-05' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2018-05'  group by uid having sum(money/100)<100  )a group by level union all select '2018-06' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2018-06'  group by uid having sum(money/100)<100  )a group by level union all select '2018-07' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2018-07'  group by uid having sum(money/100)<100  )a group by level union all select '2018-08' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2018-08'  group by uid having sum(money/100)<100  )a group by level union all select '2018-09' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2018-09'  group by uid having sum(money/100)<100  )a group by level union all select '2018-10' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2018-10'  group by uid having sum(money/100)<100  )a group by level union all select '2018-11' as month, level,count(uid) from (select uid,ceil(sum(money/100)/10) as level from pay_syn_day where date<'2018-11'  group by uid having sum(money/100)<100  )a group by level ) a
